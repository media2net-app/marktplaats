"use strict";exports.id=908,exports.ids=[908],exports.modules={95908:(r,e,i)=>{i.d(e,{_:()=>p,c:()=>u,listFiles:()=>f});var t=i(63604),s=i(55315),a=i.n(s),n=i(92048),l=i.n(n);let o=process.env.MEDIA_ROOT||"./public/media",c=!!process.env.BLOB_READ_WRITE_TOKEN;async function u(r,e,i){if(c){let e=await (0,t.gz)(i,r,{access:"public",addRandomSuffix:!1});return{path:e.url,url:e.url}}{let t=a().join(o,e);await l().promises.mkdir(t,{recursive:!0});let s=a().join(t,i),n=Buffer.from(await r.arrayBuffer());return await l().promises.writeFile(s,n),{path:`/media/${e}/${i}`}}}async function f(r){if(!r)return[];if(c)try{let{list:e}=await Promise.resolve().then(i.bind(i,63604));return(await e({prefix:r})).blobs.map(r=>r.url)}catch(r){return console.error("Error listing blobs:",r),[]}else{let e=a().join(o,r);try{if(!l().existsSync(o)||!l().existsSync(e))return[];return(await l().promises.readdir(e)).filter(r=>{let e=a().extname(r).toLowerCase();return[".jpg",".jpeg",".png",".heic"].includes(e)}).map(e=>`/media/${r}/${e}`)}catch(r){return console.error("Error listing local files:",r),[]}}}async function p(r,e){if(r.startsWith("http")){if(c)try{await (0,t.IV)(r)}catch(r){console.warn("Error deleting blob file:",r)}}else{let i=r.startsWith("/")?a().join("./public",r):a().join(o,e||"",r);try{await l().promises.unlink(i)}catch(r){console.warn("Error deleting local file:",r)}}}}};